@* PaginacionLocal.razor refactorizado *@

@if (TotalElementos > 0)
{
    <div class="pagination-container">
        <div class="pagination-info">
            @* Siempre mostramos info, aunque solo sea una página *@
            Mostrando <b>@CalcularRangoInicio()</b> a <b>@CalcularRangoFin()</b> de <b>@TotalElementos</b> registros
        </div>

        @* Solo mostramos los controles de navegación si realmente hay más de una página *@
        @if (TotalPaginas > 1)
        {
            <div class="pagination-buttons">
                <button class="pag-btn" disabled="@(!CanGoPrev)" @onclick="() => CambiarPagina(1)" title="Primera">
                    <i class="fas fa-angle-double-left"></i> ⏮
                </button>

                <button class="pag-btn" disabled="@(!CanGoPrev)" @onclick="() => CambiarPagina(PaginaActual - 1)" title="Anterior">
                    <i class="fas fa-angle-left"></i> ◀
                </button>

                <span class="pag-text">
                    Página <b>@PaginaActual</b> de <b>@TotalPaginas</b>
                </span>

                <button class="pag-btn" disabled="@(!CanGoNext)" @onclick="() => CambiarPagina(PaginaActual + 1)" title="Siguiente">
                    <i class="fas fa-angle-right"></i> ▶
                </button>

                <button class="pag-btn" disabled="@(!CanGoNext)" @onclick="() => CambiarPagina(TotalPaginas)" title="Última">
                    <i class="fas fa-angle-double-right"></i> ⏭
                </button>
            </div>
        }
    </div>
}

@code {
    [Parameter] public int PaginaActual { get; set; } = 1;
    [Parameter] public int TotalPaginas { get; set; } = 1;
    [Parameter] public int TotalElementos { get; set; } = 0;
    [Parameter] public int ElementosPorPagina { get; set; } = 5;
    [Parameter] public EventCallback<int> OnPageChange { get; set; }

    bool CanGoPrev => PaginaActual > 1;
    bool CanGoNext => PaginaActual < TotalPaginas;

    // Lógica para mostrar "Mostrando 1 a 4 de 4"
    private int CalcularRangoInicio() => ((PaginaActual - 1) * ElementosPorPagina) + 1;
    private int CalcularRangoFin() => Math.Min(PaginaActual * ElementosPorPagina, TotalElementos);

    public async Task CambiarPagina(int nuevaPagina)
    {
        if (nuevaPagina != PaginaActual && nuevaPagina >= 1 && nuevaPagina <= TotalPaginas)
        {
            await OnPageChange.InvokeAsync(nuevaPagina);
        }
    }
}